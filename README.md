# Effective_Mobile Test tasks for backend vacancy

## Проделанные работы

Требования по функционалу обеих задач выполнены,
однако(!) в первой задаче не совсем ясно данные по остаткам должны быть уникальными...

- для определенного товара в определенном магазине?
- или записи ограничиваются уникальностью заказа?

В виду этого, в основной версии сервиса (**ветка Main**)
сервис реализован таким образом, что записи уникальны
*в рамках ИД магазина + Артикул товара.*

И на основании этого идет следующая логика:

В ячейке заказа подразумевается общее число заказанного количества товара.
Поэтому, при уменьшении определенного товара в ячейке определенного магазина,
его количество в заказе пропорционально увеличивается.
А при POST-запросах с одной и той же ключевой парой
(ИД магазина + Артикул товара) новых записей не создается, а вносятся правки в имеющуюся.

В ветке **DEV** реализована другая логика, и при уменьшении товара в ячейке,
количество в заказе остается неизменным, а при POST-запросах создаются новые записи.

## Для удобства тестирования

- Добавлены файлы для swagger.io
- Добавлена коллекция Postman-запросов

## Запуск

1. Первым делом запускаем БД:
Она сохранена в файл database.backup (запускается через pgAdmin)
Если нет pgAdmin/не подтянулись таблицы или роли/возникли другие непредвиденные ошибки
То в вашей среде исполнения SQL нужно выполнить скрипт из файла db_init.sql
2. Далее поочередно переходим в директории сервисов и из них запускаем команды:

- npm install
- npm run build *кроме основного сервиса первого задания*
- npm start

## Technical description

### **Задание 1**

Нужно реализовать 2 сервиса.

#### Сервис остатков товаров в магазине

<details>

У товара могут быть следующие поля:

- PLU - артикул товара
- Название товара
- Количество товара на полке
- Количество товара в заказе
- Для какого магазина данных остаток

Данные денормализованы, их нужно привести к 2-3 нормальной форме.
Должны быть следующие endpoint:

- Создание товара
- Создание остатка
- Увеличение остатка
- Уменьшение остатка
- Получение остатков по фильтрам
  1 plu
  2 shop_id
  3 количество остатков на полке (с-по)
  4 количество остатков в заказе (с-по)
- Получение товаров по фильтрам
  1 name
  2 plu

</details>

#### Сервис истории действий с товарами

<details>

В сервис “истории действий с товарами” нужно отправлять все события,
которые происходят с товарами или остатками.
Общение сервисов может происходить любым способом.
Сервис “истории действий с товарами или остатками” должен иметь endpoint,
который отдаст историю действий с фильтрами по:

- shop_id
- plu
- date (с-по)
- action

и постраничной навигацией. Фреймворк так же может быть любой, но не nest.

- Один из сервисов должен быть на JS
- Для второго можно использовать TS.
- СУБД - postgresql

</details>

### **Задание 2**

<details>

Нужно написать сервис, который работает с пользователями.
В бд может быть более 1 миллиона пользователей
(набить данными бд нужно самостоятельно.
Например, написать миграцию, которая это сделает). Каждый пользователь имеет поля:

- Имя
- Фамилия
- Возраст
- Пол
- проблемы: boolean // есть ли проблемы у пользователя

Нужно сделать endpoint, который проставить флаг проблемы у пользователей в false
и посчитает, сколько пользователей имело true в этом флаге.
**Этот сервис нужно реализовать на nestjs.**

</details>
